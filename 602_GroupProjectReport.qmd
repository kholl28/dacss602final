---
title: "The Impact of Crime Severity and Recidivism on Attitudes towards Felon Voting Rights"
subtitle: "602 (Fall 2023)"
author: Kenneth Bufford, Kai Holl, Esiquio Iglesias Guerra
format: 
  html:
    toc: true
    toc-depth: 2
    toc-title: Contents
    toc-location: left
    html-math-method: katex
    theme: flatly
    smooth-scroll: true
    link-external-icon: true
    link-external-newwindow: true
    citations-hover: true
    footnotes-hover: true
    font-size: 80%
---

<!--
ATTENTION: PLEASE SUBMIT both your qmd file and html file.
-->


<!--
Replace the placeholders (title and author) with yours in the yaml above.
-->


# Project Description
<!--
With the growing research into the punitive nature of the 13th Amendment, 
sociologists have begun to question the ways in which we mistreat felons 
and those incarcerated. One significant inquiry is who will advocate for 
those currently serving time. In 26 states, it is legal to disenfranchise 
felons, preventing them from ever voting again in specific municipalities. 
To understand how felon enfranchisement would impact our general population, 
we first examine the factors leading to continuous felon disenfranchisement.

In our survey, we investigate how the severity of the crime and the intention 
for recidivism affect people’s perceptions of whether voting rights should be 
restored to a felon in prison. We hypothesize that the more severe the crime, 
the less likely someone is to have their enfranchisement rights restored while 
serving time and that if someone intends to recidvise they will be less likely 
to have their enfranchisement restored in prison. Additionally, we explore how 
a respondent’s general attitudes towards felons moderate this relationship. 
If people generally hold negative perceptions of felons, we inquire about the 
impact of providing information about felons and their recidivism rates on the 
chances of enfranchisement.
-->


```{r}
#| label: setup
#| warning: false
#| message: false

# library(ggpubr)
# library(naniar)
library(tidyr)
library(haven)
library(tidyverse)
library(explore)
library(haven)
library(stringr)
library(ggpubr)
library(ltm)

knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
```


```{r warning = FALSE, message = FALSE}

# Ese, your data cleaning code should go here!


survey.data <- read_csv("/Users/kaiholl/Documents/GitHub/dacss602final/survey_data_v2.csv")

# renaming columns to make referencing them easier
# --------------------------------
oldnames = c("...1","(att)g4q1_1_honest living","(att)g4q1_2_next door","(att)g4q1_3_rehabilitate","(att)g4q1_4_productivelives","(att)g4q1_5_immoral","(att)g4q1_6_circumstance","(att)g4q1_7_trust","(att)g4q1_8_guard","(att)g4q1_9_parole","(control)g4q2_felonsvote","g4q3_white_lowc_noitd","g4q4_nowhite_lowc_noitd","g4q5_white_medc_noitd","g4q6_nowhite_medc_noitd","g4q7_white_highc_noitd","g4q8_nowhite_highc_noitd","g4q9_white_lowc_itd","g4q10_nowhite_lowc_itd","g4q11_white_medc_itd","g4q12_nowhite_medc_itd","g4q13_white_highc_itd","g4q14_nowhite_highc_itd","g4jail1_youincar","g4jail2_famfrdincar")

newnames = c("respondent","honest.living","next.door","rehab","productive","immoral","circumstance","trust","guard","parole","vote.info","white.low.nor","non.low.nor","white.med.nor","non.med.nor","white.high.nor","non.high.nor","white.low.r","non.low.r","white.med.r","non.med.r","white.high.r","non.high.r","you.jail","famfrd.jail")

# Info on Column Names
# --------------------------------
# ATTITUDES SCALE - full Questions
# honest.living = Most felons are too lazy to earn an honest living. **(REVERSE SCORED)**
# next.door = I wouldn’t mind living next door to an ex-felon.
# rehab = Trying to rehabilitate felons is a waste of time and money. **(REVERSE SCORED)**
# productive = Given the right conditions, felons can lead productive lives and become law-abiding citizens.
# immoral = Felons are just plain immoral. **(REVERSE SCORED)**
# circumstance = Felons are victims of circumstance and deserve to be helped.
# trust = It is wise to trust a felon.
# guard = You have to be constantly on your guard with felons. **(REVERSE SCORED)**
# parole = If a person does well in prison, he/she should be let out on parole.

# VIGNETTES
# white = white felon
# non = non-white felon
# low = low crime severity, tax fraud
# med = medium crime severity, armed robbery
# high = high crime severity, sexual offense against a child
# nor = no intention to recidivate, ie. do not intend to recommit crimes once out of prison
# r = intention to recidiviate, ie. do intend to recommit crimes once out of prison


# Recoding Attitude Responses to Numeric
# --------------------------------
survey.data <- survey.data %>%
  dplyr::select(-c(DistributionChannel, Consent)) %>% # removing some unnecessary columns
  rename_at(vars(oldnames), ~ newnames) %>%  
  mutate(across(c("next.door","productive","circumstance","trust","parole","vote.info"), # normal worded positive scale items plus vote.info variable
            ~case_when(
              grepl("Strongly disagree", .) ~ 1,
              grepl("Disagree", .) ~ 2,
              grepl("Agree", .) ~ 3,
              grepl("Strongly agree", .) ~ 4))) %>%
    mutate(across(c("honest.living","rehab","immoral","guard"), # recoding reverse worded survey items
            ~case_when(
              grepl("Strongly disagree", .) ~ 4,
              grepl("Disagree", .) ~ 3,
              grepl("Agree", .) ~ 2,
              grepl("Strongly agree", .) ~ 1)))

# Tabulating a Total Attitudes Score for Each Respondent
# --------------------------------
survey.data <- survey.data %>%
  mutate(attitudes = rowSums(.[3:11]) - 9, .after = "parole")

# 0 = most negative attitudes towards felons possible
# 27 = most positive attitudes towards felons possible

# Creating Summary df
# --------------------------------
vignettes <- survey.data %>%
  dplyr::select(14:25) 

respondent.df <- survey.data %>%
  mutate(v.condition = names(vignettes)[max.col(!is.na(vignettes))], .after = "non.high.r") %>% 
  mutate(felon.race = case_when(
    str_detect(v.condition, "white") ~ "white",
    str_detect(v.condition, "non") ~ "non-white"), .after = "v.condition") %>% 
  mutate(crime.sev = case_when(
    str_detect(v.condition, "low") ~ "low",
    str_detect(v.condition, "med") ~ "medium",
    str_detect(v.condition, "high") ~ "high"), .after = "felon.race") %>%
   mutate(recidivism = case_when(
    str_detect(v.condition, "nor") ~ "no intent",
    str_detect(v.condition, "r") ~ "intent"), .after = "crime.sev") %>% 
  mutate(v.response = coalesce(white.low.nor,non.low.nor,white.med.nor,non.med.nor,white.high.nor,non.high.nor, # v.response = survey participant's response to vignette
                               white.low.r,non.low.r,white.med.r,non.med.r,white.high.r,non.high.r), .after = "recidivism") %>% 
  dplyr::select(-14:-25, -v.condition)

# Turning variables into factor variable
# --------------------------------
respondent.df$crime.sev <- factor(respondent.df$crime.sev, levels = c("low", "medium", "high"))
respondent.df$v.response <- factor(respondent.df$v.response, levels = c("No", "Yes"))


# Creating new column for respondent history of incarceration
# --------------------------------
# you.jail = "Have you ever been incarcerated (sentenced to prison)" Yes/No
# famfrd.jail = "Has a friend or family members of yours ever been incarcerated (sentenced to prison)?" Yes/No

respondent.df <- respondent.df %>% 
  mutate(jail = case_when(
    you.jail == "Yes" | famfrd.jail == "Yes" ~ "Yes",
    you.jail == "No" | famfrd.jail == "No" ~ "No"), .after = "famfrd.jail")
```


# Descriptive Summary
<!--
One descriptive table and/or plot: Provide an overview of all the variables used in the statistical test. For example, the mean, standard deviation, range (min/max), contingency table, etc.
-->

```{r}
# race
# crime severity
# vignette response (DV)

table(respondent.df$felon.race, respondent.df$v.response)
# non-white: no = 86, yes = 48
# white: no = 86, yes = 43

table(respondent.df$crime.sev, respondent.df$v.response)
# No:
# low = 58
# medium = 53
# high = 61

# Yes:
# low = 31
# medium = 35
# high = 25

table(respondent.df$recidivism, respondent.df$v.response)
#

summary(respondent.df$attitudes)
# most positive attitudes towards felons: 27
# most negative attitudes towards felons: 0

# table() makes a contingency table

table(respondent.df$v.response)
# no = 172
# yes = 91
```



# Findings
<!--
Findings: Report the statistic you obtained along with the information to decide whether the null hypothesis can be rejected or not. Use a plot and/or table with a proper label.
-->

```{r}
# What variables do we want to compare to each other to see if there is a relationship?

# Attitudes vs. Vignette Response = point-biserial correlation test
# Race of felon vs. Vignette Response = chi-squared test
# Crime Severity vs. Vignette Response = chi-squared test
# Recidivism Intention vs. Vignette Response = chi-squared test


# Attitudes vs. Vignette Response
# --------------------------------
respondent.df <- respondent.df %>%
  mutate(v.response = case_when(
              v.response == "No" ~ "0",
              v.response == "Yes" ~ "1"))

biserial.cor(respondent.df$attitudes, respondent.df$v.response, use = c("all.obs"), level = 1)
biserial.cor(respondent.df$attitudes, respondent.df$v.response, use = c("all.obs"), level = 2)
# level 1 = no response to vignette
# -0.2203021
# level 2 = yes response to vignette
# 0.2203021
# normal relationship, not very strong

# https://medium.com/@RaharditoDP/point-biserial-correlation-in-r-70e713caa7a0


# Race of felon vs. Vignette Response
# --------------------------------
chisq.test(respondent.df$felon.race, respondent.df$v.response)
# p-value = 0.7685
# so, fail to reject the null hypothesis (p > 0.05)
# x-squared = 0.086612 
# df = 1


# Crime Severity vs. Vignette Response
# --------------------------------
chisq.test(respondent.df$crime.sev, respondent.df$v.response)
# p-value = 0.332
# so, fail to reject the null hypothesis (p > 0.05)
# x-squared = 2.205
# df = 2


# Recidivism Intention vs. Vignette Response
# --------------------------------
chisq.test(respondent.df$recidivism, respondent.df$v.response)
# p-value = 0.01084
# so, reject the null hypothesis (p < 0.05), yay!
# x-squared = 6.4907
# df = 1


# Incarceration History vs. Vignette Response
# --------------------------------
chisq.test(respondent.df$jail, respondent.df$v.response)
# p-value = 0.4388
# so, fail to reject the null hypothesis (p > 0.05)
# x-squared = 0.59935
# df = 1
```

```{r}
# https://www.r-bloggers.com/2021/08/how-to-plot-categorical-data-in-r-quick-guide/#:~:text=A%20useful%20technique%20to%20show,is%20to%20use%20grouped%20boxplots.&text=The%20teams%20are%20represented%20on,represented%20on%20the%20y%2Daxis

# https://rkabacoff.github.io/datavis/Bivariate.html

# Attitudes vs. Vignette Response
# Race of felon vs. Vignette Response = chi-squared test
# Crime Severity vs. Vignette Response = chi-squared test
# Recidivism Intention vs. Vignette Response = chi-squared test


# Relationship between Attitudes and Vignette Response
# --------------------------------
respondent.df %>%
  ggplot(aes(v.response, attitudes)) +
  geom_boxplot(fill='lightskyblue') +
  theme_minimal() +
  labs(x = "Vignette Response", y="Total Attitudes Score", title = "Relationship between Attitudes and Vignette Response")

respondent.df %>%
  group_by(v.response) %>%
  count(attitudes) %>%
  ggplot(aes(attitudes, n, colour = v.response, group = v.response)) +
  geom_line(lwd = 1) +
  theme_minimal() +
  theme(legend.position = 'bottom') +
  scale_colour_hue(labels=c("Voting rights restored", "voting rights NOT restored")) +
  labs(x = "Total Attitudes Score", y = "Count", colour = "Vignette Response", title = "Relationship btw/ attitudes towards felons and decision to restore felon voting rights")


# Relationship between Race of Felon and Vignette Response 
# --------------------------------
respondent.df %>%
  ggplot(aes(felon.race, fill = factor(v.response, 
                                     levels = c("0", "1"),
                                     labels = c("no", "yes")))) +
  geom_bar(position = "fill", width = 0.7) +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1", name = "Voting Rights Restored?", labels = c("No", "Yes")) +
  scale_y_continuous(labels = scales::percent_format(accurary = 1)) +
  labs(x = "Race of Felon", y="Proportion (%)", title = "Effect of Felon Race on Voting Rights Restoration")


# Relationship between Crime Severity and Vignette Respone 
# --------------------------------
respondent.df %>%
  ggplot(aes(v.response, fill = crime.sev)) +
  geom_bar(position = position_dodge(preserve = "single"), width = 0.7) +
  scale_fill_manual(name = "Crime severity", values = c("lightgreen", "khaki", "indianred")) +
  scale_x_discrete(name = "Voting Rights Restored?", labels = c("No", "Yes")) +
  theme_minimal() +
  labs(x = "Vignette Response", y="Count", title = "Effect of Crime Severity on Voting Rights Restoration")

# The majority of respondents said No to restoring voting rights to the felon.
# Respondents were marginally more likely to restore voting rights to a felon with a medium crime severity than a low or high crime severity **NEED TO CHECK SIGNIFICANCE**


# Relationship between Recidivism Intention and Vignette Response
# --------------------------------
respondent.df %>%
  ggplot(aes(v.response, fill=recidivism)) +
  geom_bar(position="fill", width = 0.7) +
  theme_minimal() +
   scale_x_discrete(name = "Voting Rights Restored?", labels = c("No", "Yes")) +
  scale_y_continuous(labels = scales::percent_format(accurary = 1)) +
  labs(x = "Vignette Response", y="Proportion (%)", title = "Effect of Felon Recidivism Intention on Voting Rights Restoration", fill = "Recidivism Intention")

# plot shows that when shown a vignette of a felon who intends to recommit the crime once released from prison, independent of the severity of the crime committed or the race of the felon, respondents are more likely to not restore rights to the felon compared to respondents who received vignettes of felons who did NOT intend to recidivise. 
```


# Interpretation
<!--

Discussion of Chi-Square Test:
We conducted Chi-Square tests on four distinct groups: Race of Felon vs. Vignette Response, 
Crime Severity vs. Vignette Response, Recidivism Intention vs. Vignette Response, 
and Incarceration History vs. Vignette Response. Among these, Race of Felon, Crime Severity, 
and Incarceration History yielded non-significant p-values. This indicates that we cannot reject 
the null hypothesis, suggesting no significant mean variance between the groups in these cases.
On the contrary, Recidivism Intention and Response displayed a P-Value of 0.01084, allowing us 
to reject the null hypothesis. This implies a discernible difference between the groups. 
Specifically, the intention of recidivism appears to influence the likelihood of voting in favor 
of enfranchisement. The significance of this finding underscores the impact that respondents' 
perceptions of an individual's likelihood to reoffend have on their stance toward enfranchisement.


Visualizations and Communication:
Examining bar graphs where results are segmented by variables and color-coded for interpretation 
reveals intriguing insights. The initial graph illustrates the connection between attitudes and 
vignette responses. Higher attitudes correlate with felons being more inclined to vote for enfranchisement. 
Divergent outcomes emerge across varying levels of crime severity. Notably, perceived non-violent 
crimes show little distinction from high-severity crimes. Conversely, crimes like robbery are 
perceived as more conducive to enfranchisement. Another finding indicates that race does not 
influence who is enfranchised. Non-white individuals are only marginally more likely to be 
re-enfranchised, with no significant difference. Turning our attention to recidivism intention, it 
plays a role in determining someone's likelihood of being re-enfranchised. Just over half of survey 
respondents, when informed about a defendant likely to recommit the crime post-release, voted against
enfranchising felons. This suggests that when negative information about felons is presented before 
voting, there's an almost 50-50 chance of a 'no' vote. Conversely, the intention not to recommit the 
crime resulted in 62% of respondents voting to enfranchise felons. When individuals have a genuine 
support system and are committed to rehabilitation, there's a higher likelihood of voting for enfranchisement, 
even while the individual is still in prison.

Social and Economic Considerations:
While we controlled for race and income, we believe another factor may explain the perception of 
armed robbery. Traditionally, crimes like robbery don't occur in a vacuum; they often stem from 
socioeconomic factors, where individuals, having limited options, resort to crime, unlike offenses 
such as tax evasion and pedophilia.

Suggestions for Future Research:
In future research, we aim to delve into specific points to gain a deeper understanding. First, 
we want to explore why armed robbery, considered a middle-severity crime, was perceived more 
favorably than tax evasion. Were our categorizations of non-violent crimes accurate, or do 
certain non-violent crime saliences predispose people to vote in a certain way? Now that we 
know race plays no significant role, further investigation into the three main groups of low, 
middle, and high severity crimes and how perception influences them is warranted.

Limitations of the Study:
Our study surveyed only 263 people, a sample size insufficient for extrapolating inferences about
the broader U.S. community. Furthermore, with 12 different groups, each consisting of fewer than
30 people, the sample distribution poses limitations. Additionally, the perception of crime severity
may vary; what we consider less severe might be perceived differently by others online.
-->

